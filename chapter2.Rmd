# Chapter 2: Regression and model validation 

*Describe the work you have done this week and summarize your learning.*

- Describe your work and results clearly. 
- Assume the reader has an introductory course level understanding of writing and reading R code as well as statistical methods.
- Assume the reader has no previous knowledge of your data or the more advanced methods you are using.


**In this chapter we will explore the dataset from *http://www.helsinki.fi/~kvehkala/JYTmooc/JYTOPKYS3-data.txt*, looking first closer at the dataframe and afterwards visualize some
interesting features.**

## Data wrangling 
**REMARK: The data wrangling part is done in the .R file in the data-folder. Still, I will show a preview of the original dataset in the diary as it shows the development from the original data to the dataset we finally evaluate.**

### Looking at the original dataset

First let's read in the full learning2014 data as a dataframe from the given website.
```{r}
lrn14 <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/JYTOPKYS3-data.txt", sep="\t", header=TRUE)
head(lrn14)
```
Only looking at the head of the dataframe makes it quite visible that some data wrangling will help in understanding the data better. It also shows that meta data is quite valuable as we don't know by just looking at the variable what their meaning is.

## Data analysis
### Preparing an analysis sub dataset for further data exploration
For this we have to include the library *dplyr* (```library(dplyr)```) which is a common R library used for data wrangling
```{r,message=FALSE}
library(dplyr)
```

### Looking at the new data subset
**Reading in the data from a .csv created in the project subfolder**

First let's use ```read.csv()``` or ```read.table()``` to read in the data subset created before and display the head of it.
```{r, results='hide'}
students2014 <- read.csv("./data/learning2014.csv", header = TRUE, sep = ",")
students2014b <- read.table("./data/learning2014.txt", sep = "\t", header = TRUE)
```

```{r}
head(students2014)
```

**Structure and dimension of the subset**
```{r}
dim(students2014)
str(students2014)

```
This sub dataset consists of 7 variables (which were defined above) and 183 observations. The datatypes consist of 4 *numerical* type variables which give us the grade that the 
students obtained in the respective categories in the scale (0-5), 2 *integer* type variables giving the age and the points, and one *character* type variable stating the gender.

**Getting rid of 0 values**
```{r}
# select rows where points are greater than zero
students2014 <- filter(students2014, points > 0) 
students2014b <- filter(students2014b, points > 0) 
dim(students2014)

```
As one can see we have $183-166=17$ rows with 0 points, so students not taking the final exam.

### Visualizations
**Graphical overview of the data**


```{r}
library(ggplot2)
library(GGally)
# create a plot matrix with ggpairs()
ggpairs(students2014, mapping = aes(col = gender, alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
summary(students2014)
```

### Regression model
From the pairs plot above let's choose the 3 variables with highest correlation to points as explanatory variables to be used for the regression model. The exam points
will then be our target variable: **exam points ~ x1 + x2 + x3**. The respective variables would be *attitude*, *stra* and *surf*.
**Further description and interpretation will still be added.**
```{r}
# create a regression model with multiple explanatory variables
my_model <- lm(points ~ attitude + stra + surf, data = students2014)
summary(my_model)
```

```{r}
my_model2 <- lm(points ~ attitude + stra, data = students2014)
summary(my_model2)
```

```{r}
my_model3 <- lm(points ~ attitude, data = students2014)
summary(my_model3)
```

### Diagnostics plot
```{r}
#par(mfrow = c(2,2)) #To put the images in the same figures. However, I prefer them a bit bigger right now.
plot(my_model2, which=c(1,2,5))
```
**Description and interpretation will still be added.**